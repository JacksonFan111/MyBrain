<!DOCTYPE html>
<html>
    <head>
        <title>Jackson Fan : 2.Funds Under Management (FUM) - One Pager</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jackson Fan</a></span>
                            </li>
                                                    <li>
                                <span><a href="JF-Space-Overview_2554888272.html">JF Space Overview</a></span>
                            </li>
                                                    <li>
                                <span><a href="Circuit-Breaker-notes_3198779447.html">Circuit Breaker notes</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jackson Fan : 2.Funds Under Management (FUM) - One Pager
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                            
        
    
        
    
        
        
            Created by <span class='author'> Jackson Fan</span>, last modified on 08-06-25
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h3 id="id-2.FundsUnderManagement(FUM)-OnePager-TechnicalDocumentation–SQL/TabularDeveloperView"><em>Technical Documentation – SQL / Tabular Developer View</em></h3><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-1BusinessPurpose">1 Business Purpose</h2><p><em>Funds Under Management</em> is the <strong><span style="background-color: rgb(211,241,167);">core position fact</span></strong><span style="background-color: rgb(211,241,167);"> in the </span><em><span style="background-color: rgb(211,241,167);">CIP Tabular Model</span></em>.<br/>It stores </p><p><strong>lot-level holdings</strong> (Quantity, Value, Cost, Dates, Flags) for <strong><span style="background-color: rgb(211,241,167);">every Account × Asset × Valuation-date</span></strong> combination and drives:</p><ul><li><p>Client &amp; adviser FUM dashboards</p></li><li><p>Liquidity / cash-man reconciliations</p></li><li><p>Performance, cost-basis, and unrealised-gain analytics</p></li><li><p>Down-stream aggregates (e.g., <strong>Holdings Tabular</strong>, Daily Movements, Funds-flow cubes)</p></li></ul><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-2Up-streamLineage&amp;Refresh">2 Up-stream Lineage &amp; Refresh</h2><div class="table-wrap"><table data-table-width="1054" data-layout="center" data-local-id="42bcc6f5-67a4-47a3-bcf1-cf68fa096d5c" class="confluenceTable"><colgroup><col style="width: 266.0px;"/><col style="width: 436.0px;"/><col style="width: 351.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Stage</p></th><th class="confluenceTh"><p>Object</p></th><th class="confluenceTh"><p>Action</p></th></tr><tr><td class="confluenceTd"><p><strong>Custody sources</strong></p></td><td class="confluenceTd"><p>Daily files (ISO 20022 / CSV) from CSL?</p></td><td class="confluenceTd"><p>Raw positions, prices, accruals</p></td></tr><tr><td class="confluenceTd"><p><strong>Synapse layer</strong></p></td><td class="confluenceTd"><p><code>[Trading].[F_FundsUnderManagement_v]</code></p><p>We got a SQL Pool to managed that</p></td><td class="confluenceTd"><p>SQL view adds NZD valuation, FX, dates, joins dims</p></td></tr><tr><td class="confluenceTd"><p><strong>Tabular partition</strong></p></td><td class="confluenceTd"><p><em>Query</em> (XMLA)</p></td><td class="confluenceTd"><p>Full refresh (02:00 NZT) via query shown in XML</p></td></tr><tr><td class="confluenceTd"><p><strong>Model calcs</strong></p></td><td class="confluenceTd"><p>Calculated columns + measures (DAX)</p></td><td class="confluenceTd"><p>Cost totals, managed-status logic, YoY KPIs</p></td></tr></tbody></table></div><p><strong>Refresh cadence:</strong> <span style="background-color: rgb(211,241,167);">nightly (entire table re-pulled); can be switched to incremental by </span><code>HoldingDateKey</code><span style="background-color: rgb(211,241,167);"> if history explodes</span>.</p><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-3TableGrain">3 Table Grain</h2><p>One row per <strong><span style="background-color: rgb(198,237,251);">AccountKey × AssetKey × HoldingDateKey</span></strong><span style="background-color: rgb(198,237,251);"> (lot-level)</span>.<br/>Hidden surrogate keys allow joins; business keys live in dimensions.</p><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-4PhysicalSchema(SelectedHighlights)">4 Physical Schema (Selected Highlights)</h2><div class="table-wrap"><table data-table-width="1194" data-layout="center" data-local-id="84d63e47-a923-4cdd-9cd2-bf294f840c7b" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Column</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Hidden</p></th><th class="confluenceTh"><p>Comment</p></th></tr><tr><td class="confluenceTd"><p><code>AccountKey</code>, <code>AssetKey</code>, <code>HoldingDateKey</code></p></td><td class="confluenceTd"><p>bigint</p></td><td class="confluenceTd"><p>✔</p></td><td class="confluenceTd"><p>Surrogate keys to dims</p></td></tr><tr><td class="confluenceTd"><p><code>Quantity</code>, <code>Price</code>, <code>Value Local</code>, <code>FX Rate</code>, <code>Value NZD</code></p></td><td class="confluenceTd"><p>double</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>Position metrics (stored as <em>numeric</em>, not decimal)</p></td></tr><tr><td class="confluenceTd"><p><code>Is Safe Custody</code>, <code>Is Cashman</code>, <code>Is Term Deposit</code></p></td><td class="confluenceTd"><p>string</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>Classification flags</p></td></tr><tr><td class="confluenceTd"><p><code>Average/Mkt Cost</code>, <code>NZD Cost</code>, <code>Market Cost</code></p></td><td class="confluenceTd"><p>double</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>Cost-basis fields</p></td></tr><tr><td class="confluenceTd"><p><code>Min/Max NZD Held</code>, <code>Daily Average NZD</code>, <code>Days Held</code></p></td><td class="confluenceTd"><p>bigint</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>Time-series support</p></td></tr><tr><td class="confluenceTd"><p><code>First Held Date</code>, <code>Last Held Date</code></p></td><td class="confluenceTd"><p>date</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>Holding-window tracking</p></td></tr><tr><td class="confluenceTd"><p><strong>Calculated</strong> <code>FUM Value</code></p></td><td class="confluenceTd"><p>double</p></td><td class="confluenceTd"><p>•</p></td><td class="confluenceTd"><p>NZD value <strong>only</strong> if Managed OR Cashman OR Safe Custody</p></td></tr></tbody></table></div><p><em>Encoding hints = </em><code>value</code><em> → columnar storage optimised for numbers.</em></p><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-5CalculatedColumns(DAX)">5 Calculated Columns (DAX)</h2><h3 id="id-2.FundsUnderManagement(FUM)-OnePager-FUMValue"><strong>FUM Value</strong></h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">IF ( RELATED(&#39;Service Levels&#39;[Is Managed]) = &quot;Yes&quot;
     || [Is Cashman] = &quot;Y&quot;
     || [Is Safe Custody] = &quot;Y&quot;,
     [Value NZD],
     0 )
</pre>
</div></div><p><em>Filters unmanaged/excluded positions from most KPIs.</em></p><h3 id="id-2.FundsUnderManagement(FUM)-OnePager-TotalCostNZD"><strong>Total Cost NZD</strong></h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">[Average NZD Cost] * [Quantity]
</pre>
</div></div><p><em>Row-level cost basis used in gain calculations.</em></p><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-6KeyMeasures(excerpt)">6 Key Measures (excerpt)</h2><div class="table-wrap"><table data-table-width="1230" data-layout="center" data-local-id="0701eee8-a548-4662-bb2f-0d339e4d2636" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Measure</p></th><th class="confluenceTh"><p>Business question answered</p></th></tr><tr><td class="confluenceTd"><p><strong>Total FUM Value</strong></p></td><td class="confluenceTd"><p>“What is the sum of <em>FUM Value</em> under current filters?”</p></td></tr><tr><td class="confluenceTd"><p><strong>Current FUM Value</strong></p></td><td class="confluenceTd"><p>Value on latest holding date (<code>Last Holding Date=&quot;yes&quot;</code>).</p></td></tr><tr><td class="confluenceTd"><p><strong>End of Period FUM Value</strong></p></td><td class="confluenceTd"><p>Value on the max visible calendar date (EOP reporting).</p></td></tr><tr><td class="confluenceTd"><p><strong>Current / End-Period Cashman &amp; Safe-Custody Values</strong></p></td><td class="confluenceTd"><p>Liquidity buckets. Short Terms stability</p></td></tr><tr><td class="confluenceTd"><p><strong>Current Unrealised NZD Gains</strong></p></td><td class="confluenceTd"><p><code>[Current FUM] – [Current NZD Cost] – [Accrued]</code>.</p></td></tr><tr><td class="confluenceTd"><p><strong>FUM Growth (YoY / %)</strong></p></td><td class="confluenceTd"><p>Year-over-year dollar &amp; percentage growth.</p></td></tr><tr><td class="confluenceTd"><p><strong>Client Account Count metrics</strong></p></td><td class="confluenceTd"><p>Distinct open/pending accounts now vs. last year.</p></td></tr></tbody></table></div><p>Many measures reuse <code>Account Holdings Date[Last Holding Date]</code> flag to scope to the latest snapshot.</p><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-7Relationships">7 Relationships</h2><div class="table-wrap"><table data-table-width="1052" data-layout="center" data-local-id="3b59efda-8572-4f40-8c8d-e94719f09b97" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>From (this table)</p></th><th class="confluenceTh"><p>To (dimension)</p></th><th class="confluenceTh"><p>Active?</p></th><th class="confluenceTh"><p>Purpose</p></th></tr><tr><td class="confluenceTd"><p><code>AccountKey</code></p></td><td class="confluenceTd"><p><strong>Account</strong></p></td><td class="confluenceTd"><p>✔</p></td><td class="confluenceTd"><p>Slicers, RLS</p></td></tr><tr><td class="confluenceTd"><p><code>AssetKey</code></p></td><td class="confluenceTd"><p><strong>Asset</strong></p></td><td class="confluenceTd"><p>✔</p></td><td class="confluenceTd"><p>Security attributes, market filters</p></td></tr><tr><td class="confluenceTd"><p><code>FixedInterestAssetKey</code></p></td><td class="confluenceTd"><p><strong>Fixed Interest Asset</strong></p></td><td class="confluenceTd"><p>inactive</p></td><td class="confluenceTd"><p>Enable with <code>USERELATIONSHIP</code> for bond analytics</p></td></tr><tr><td class="confluenceTd"><p><code>HoldingDateKey</code></p></td><td class="confluenceTd"><p><strong>Account Holdings Date / Dates</strong></p></td><td class="confluenceTd"><p>✔</p></td><td class="confluenceTd"><p>Time-series; flag columns for latest snapshot</p></td></tr></tbody></table></div><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-8Performance&amp;Volume(Apr-2025)">8 Performance &amp; Volume (Apr-2025)</h2><ul><li><p>180 M rows (~3 years history)</p></li><li><p>1.2 GB compressed (VertiPaq) – 91 % compression</p></li><li><p>Full refresh: 12 min (Synapse → Model)</p></li><li><p>Query speed: sub-second with aggregated visuals, 3–4 s at lot detail</p></li></ul><p><strong>Tuning levers:</strong></p><ul><li><p>Partition by <code>HoldingDateKey</code> and enable incremental loads.</p></li><li><p>Switch high-volume doubles to <strong>decimal(19,4)</strong> upstream if audit precision required.</p></li><li><p>VertiPaq encoding hints already set to <em>value</em> for numerics.</p></li></ul><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-9TypicalData-QualityPitfalls&amp;Fixes">9 Typical Data-Quality Pitfalls &amp; Fixes</h2><div class="table-wrap"><table data-table-width="980" data-layout="center" data-local-id="8dfa5d77-55fd-4af7-87d6-ea0c249ecb60" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Symptom</p></th><th class="confluenceTh"><p>Likely root</p></th><th class="confluenceTh"><p>Remedy</p></th></tr><tr><td class="confluenceTd"><p>Negative Quantity but positive Value</p></td><td class="confluenceTd"><p>Short sale or custodian correction</p></td><td class="confluenceTd"><p>Confirm <code>Holding Type</code>; adjust rules in calculated column.</p></td></tr><tr><td class="confluenceTd"><p>FUM Value shows 0 for managed asset</p></td><td class="confluenceTd"><p><code>Service Levels[Is Managed]</code> not “Yes”</p></td><td class="confluenceTd"><p>Update Service-Levels dim mapping.</p></td></tr><tr><td class="confluenceTd"><p>Duplicate AssetKey rows on same date</p></td><td class="confluenceTd"><p>Corporate action (split, code change)</p></td><td class="confluenceTd"><p>Investigate Asset dim; normalised via Holdings Tabular roll-up.</p></td></tr></tbody></table></div><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-10Security&amp;Access">10 Security &amp; Access</h2><ul><li><p>Table visible to model authors; <strong>hidden</strong> columns prevent clutter.</p></li><li><p>RLS typically deployed on <code>AccountKey</code> / Adviser dimension; calculated columns inherit rules automatically.</p></li></ul><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-11Dependencies/Down-StreamObjects">11 Dependencies / Down-Stream Objects</h2><ul><li><p><strong>Holdings Tabular</strong> – aggregates latest snapshot.</p></li><li><p><strong>Daily Movements</strong> – Synapse vs. Tabular variance check.</p></li><li><p><strong>Funds Flow</strong> – Uses <code>FUM Value</code> for opening/closing MV calculations.</p></li><li><p>KPI dashboards, regulatory liquidity reporting.</p></li></ul><hr/><h2 id="id-2.FundsUnderManagement(FUM)-OnePager-12EnhancementRoad-Map">12 Enhancement Road-Map</h2><ol start="1"><li><p><strong>Decimal precision</strong> – migrate money fields to fixed-point for cent-level audit trail.</p></li><li><p><strong>Incremental processing</strong> – load yesterday’s delta only, cut refresh to &lt;3 min.</p></li><li><p><strong>Historical partition pruning</strong> – archive &gt;5-year rows to reduce memory.</p></li><li><p><strong>Dynamic managed flag</strong> – move “Is Managed” logic to config table, no code changes when service-level taxonomy evolves.</p></li></ol><hr/><h3 id="id-2.FundsUnderManagement(FUM)-OnePager-TL;DR"><strong>TL;DR</strong></h3><p><em>Funds Under Management</em> is the warehouse-sourced, lot-level fact that powers every FUM, cost-basis, and unrealised-gain metric in the CIP Tabular Model. It refreshes nightly, keys into all major dimensions, and feeds higher-level aggregates like Holdings Tabular and Daily Movements to guarantee lightning-fast dashboards and rock-solid reconciliation.</p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on 18-08-25 20:53</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
