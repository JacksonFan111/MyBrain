<!DOCTYPE html>
<html>
    <head>
        <title>Jackson Fan : 18.6 Step 8 to step 9 -CRS v3.19 SQL Columns Comprehensive Audit and Optimization</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jackson Fan</a></span>
                            </li>
                                                    <li>
                                <span><a href="JF-Space-Overview_2554888272.html">JF Space Overview</a></span>
                            </li>
                                                    <li>
                                <span><a href="4.-Service-Portal-Related_2555510852.html">4. Service Portal Related</a></span>
                            </li>
                                                    <li>
                                <span><a href="2762113156.html">18. Rebuild FATCA/CRS step 1 - 10</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jackson Fan : 18.6 Step 8 to step 9 -CRS v3.19 SQL Columns Comprehensive Audit and Optimization
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                            
        
    
        
    
        
        
            Created by <span class='author'> Jackson Fan</span>, last modified on 17-10-24
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>**This is in workscrtips &gt;&gt; Each work scrtipts do its different thing, i havenâ€™t asembly them toegther yet.</p><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="attachments/2773942273/2778169547.sql" data-nice-type="null" data-file-src="/wiki/download/attachments/2773942273/Workscipt%20%236%20%20Try%20to%20bring%20in%20Accoundetails%20and%20build%20the%20final%20CRS%20output.sql?version=1&amp;modificationDate=1729195725349&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="2778169547" data-linked-resource-type="attachment" data-linked-resource-container-id="2773942273" data-linked-resource-default-alias="Workscipt #6  Try to bring in Accoundetails and build the final CRS output.sql" data-mime-type="binary/octet-stream" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="24fb7e04-cfec-4a0e-b11c-5c5b9bb0b6e7" data-media-type="file"><img src="attachments/thumbnails/2773942273/2778169547" height="250"/></a></span>  </p><p>Account details = Step 8</p><p>Final CRS 143 Columsn out put are = Step 9</p><p>**</p><p>A Custom Fucntio ncreated to clean Address and names Accents  FATCA.CleanAccents</p><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="attachments/2773942273/2779709492.sql" data-nice-type="null" data-file-src="/wiki/download/attachments/2773942273/Workscipt%20%236.4%20%20Create%20Nams%20and%20Address%20Cleaning%20fucntion%20for%20XML.sql?version=1&amp;modificationDate=1729195854650&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="2779709492" data-linked-resource-type="attachment" data-linked-resource-container-id="2773942273" data-linked-resource-default-alias="Workscipt #6.4  Create Nams and Address Cleaning fucntion for XML.sql" data-mime-type="binary/octet-stream" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="d9a61114-bdd6-4937-83e2-c6050a533555" data-media-type="file"><img src="attachments/thumbnails/2773942273/2779709492" height="250"/></a></span> </p><p>  </p><p>Provided <strong>143 columns</strong> intended for the <code>[FATCA].[CRS_AccountDetail_Holders_Owners]</code> table. This enhanced audit focuses on:</p><ol start="1"><li><p><strong>Identifying and excluding columns meant to be blank.</strong></p></li><li><p><strong>Highlighting the source of each column:</strong></p><ul><li><p><strong>Step 5 (Data Extraction and Transformation)</strong></p></li><li><p><strong>Manual Creation (e.g., via CASE statements)</strong></p></li><li><p><strong>Intentionally Left Blank</strong></p></li></ul></li><li><p><strong>Indicating whether columns are actively used in the final output.</strong></p></li><li><p><strong>Capturing the specific logic used to create columns that involve special operations (e.g., </strong><code>CASE WHEN</code>, arithmetic operations, <code>IS NULL</code>).</p></li></ol><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-1.OverviewofEnhancedAudit"><strong>1. Overview of Enhanced Audit</strong></h3><p>The audit categorizes each column based on its source, usage, and the specific logic applied during its creation. This structured approach ensures clarity in understanding how each column is populated and facilitates future maintenance and compliance checks.</p><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-2.DetailedColumnAuditwithLogicCapture"><strong>2. Detailed Column Audit with Logic Capture</strong></h3><p>Below is the comprehensive audit of all <strong>143 columns</strong>, categorized and annotated accordingly. Columns that involve special logic have an additional <strong>&quot;Logic&quot;</strong> column to capture the specific operations used during their creation.</p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="e66cbfd3-13a5-476f-8917-0933c67f141f" data-table-display-mode="default" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p><strong>Column Name</strong></p></th><th class="confluenceTh"><p><strong>Source</strong></p></th><th class="confluenceTh"><p><strong>Creation Method</strong></p></th><th class="confluenceTh"><p><strong>Status</strong></p></th><th class="confluenceTh"><p><strong>Logic</strong></p></th><th class="confluenceTh"><p><strong>Notes</strong></p></th></tr><tr><td class="confluenceTd"><p><strong>Operation Type</strong>                            </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Direct Mapping from <code>@OperationType</code>                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Indicates the type of operation (e.g., New, Modify).                                          </p></td></tr><tr><td class="confluenceTd"><p><strong>Reporting Jurisdiction</strong>                    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Static Assignment (<code>'NZ'</code>)                              </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Hardcoded to 'NZ' (New Zealand); modify as per jurisdiction.                                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Recipient ID</strong>                              </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Concatenation of <code>Account ID</code> + <code>PortfolioNo</code>           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CONCAT(AccountID, PortfolioNo)</code>                                                            </p></td><td class="confluenceTd"><p>Ensures unique identification for each recipient.                                             </p></td></tr><tr><td class="confluenceTd"><p><strong>Reportable Account Type</strong>                   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>dsl_PortfolioServiceLevelName</code>             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p> --Created the 'CRS Type' Column based on Account type, Trading Entity Type, SubstantialControllingInterest<br/>		 -- [SQLCIP].[DataServices].[dbo].[crs_ControllingPersonTypeMapping] cp this table is for type mapping<br/>         CASE<br/>             WHEN cr.[AccountType] = 'Entity_N'<br/>                  AND cr.TradingEntityType NOT IN('Individual', 'Joint', 'Minor Under 18 yrs')<br/>                  AND cr.[PortfolioNo] IN(SELECT cr.[PortfolioNo]<br/>                                          FROM ##crmdatafatcacrs<br/>                                          WHERE cr.[SubstantialControllingInterest] = 1)<br/>             THEN '1'<br/>             WHEN cr.[AccountType] = 'Entity_N'<br/>                  AND cr.TradingEntityType NOT IN('Individual', 'Joint', 'Minor Under 18 yrs')<br/>                  AND cr.[PortfolioNo] IN(SELECT cr.[PortfolioNo]<br/>                                          FROM ##crmdatafatcacrs<br/>                                          WHERE cr.[SubstantialControllingInterest] = 0)<br/>             THEN '4'<br/>             WHEN cr.[AccountType] = 'Individual'<br/>                  AND cr.TradingEntityType IN('Individual', 'Joint', 'Minor Under 18 yrs')<br/>                  AND cr.[SubstantialControllingInterest] = 0<br/>             THEN '2'<br/>             WHEN cr.[AccountType] = 'Entity'<br/>                  AND cr.TradingEntityType NOT IN('Individual', 'Joint', 'Minor Under 18 yrs')<br/>                  AND cr.[SubstantialControllingInterest] = 0<br/>             THEN '3'<br/>             WHEN cr.[SubstantialControllingInterest] = 1<br/>             THEN cp.[CP Value]<br/>             ELSE 'ERROR'<br/>         END AS 'CRS Type',                                                                                       </p></td><td class="confluenceTd"><p>Determines account type based on service level. <br/> ah.[CRS Type]</p><p>is a case when based on AccounType                                             </p></td></tr><tr><td class="confluenceTd"><p><strong>Filer / Sponsored Entity Short Name</strong>       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Static Assignment (<code>'RYGAF'</code>)                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>'RYGAF'</code>                                                                                    </p></td><td class="confluenceTd"><p>Replace <code>'RYGAF'</code> with your organization's short name as per CRS requirements.                </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Number</strong>                            </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[PortfolioNo]</code>                          </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Direct mapping from CRM data.                                                                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Number Type</strong>                       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statements or Direct Mapping                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN condition THEN 'Type1' ELSE 'Type2' END</code>                                        </p></td><td class="confluenceTd"><p>Mapped based on predefined ENUM values (e.g., OECD601).                                       </p></td></tr><tr><td class="confluenceTd"><p><strong>PortfolioServiceLevelName</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.dsl_PortfolioServiceLevelName</code>          </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Direct mapping from CRM data.                                                                  </p></td></tr><tr><td class="confluenceTd"><p><strong>ReportingEntityType</strong>                       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statements based on <code>dsl_PortfolioServiceLevelName</code> </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN dsl_PortfolioServiceLevelName = 'Level1' THEN 'TypeA' ELSE 'TypeB' END</code>          </p></td><td class="confluenceTd"><p>Determines the reporting entity type using logical conditions.                               </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Undocumented</strong>          </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statements based on <code>TaxRegime</code>, <code>CRSCert</code>, etc.  </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN TaxRegime = 'X' AND CRSCert IS NULL THEN 'Undocumented' ELSE '' END</code>             </p></td><td class="confluenceTd"><p>Indicates undocumented accounts based on specific criteria.                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Closed</strong>                </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statements based on <code>ClosureDate</code> and <code>PortfolioServiceStatus</code> </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN ClosureDate IS NOT NULL AND PortfolioServiceStatus &lt;&gt; 'Open' THEN 'Closed' ELSE '' END</code> </p></td><td class="confluenceTd"><p>Indicates if the account was closed during the reporting period.                              </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Dormant</strong>               </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statements based on <code>RAT</code> or similar criteria    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN RAT = 1 THEN 'Dormant' ELSE '' END</code>                                              </p></td><td class="confluenceTd"><p>Indicates if the account is dormant; varies by jurisdiction.                                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction</strong>           </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry1</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction 2</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry2</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction 3</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry3</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction 4</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry4</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction 5</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry5</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN</strong>                         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN1</code>                                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN 2</strong>                       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN2</code>                                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN 3</strong>                       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN3</code>                                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN 4</strong>                       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN4</code>                                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN 5</strong>                       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN5</code>                                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type</strong>                    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN1_type</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type 2</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN2_type</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type 3</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN3_type</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type 4</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN4_type</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type 5</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN5_type</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                                                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code</strong>  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry1</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry1</code>; conditional updates applied post-initial insert.                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code 2</strong></p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry2</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry2</code>; conditional updates applied post-initial insert.                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code 3</strong></p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry3</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry3</code>; conditional updates applied post-initial insert.                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code 4</strong></p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry4</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry4</code>; conditional updates applied post-initial insert.                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code 5</strong></p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry5</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry5</code>; conditional updates applied post-initial insert.                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Name Type (Direct Individuals and Organizations)</strong> </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Requires manual population based on reporting requirements.                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Organization Name</strong>          </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Business Name]</code>                         </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Business Name</code> in <code>##AccountHolders</code>.                                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Organization Name Type</strong>     </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Requires manual population if needed.                                                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Preceding Title</strong>            </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Title</strong>                      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder First Name</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.FirstName</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>FirstName</code> in <code>##AccountHolders</code>.                                           </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder First Name Type</strong>            </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Middle Name</strong>                </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.MiddleName</code>                               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>MiddleName</code> in <code>##AccountHolders</code>.                                          </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Middle Name Type</strong>           </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Name Prefix</strong>                </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Name Prefix Type</strong>           </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Last Name</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.LastName</code>                                  </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>LastName</code> in <code>##AccountHolders</code>.                                            </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Last Name Type</strong>             </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Generation Identifier</strong>      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Suffix</strong>                     </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder General Suffix</strong>             </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Address Type</strong>               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Country Code]</code>                       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Country Code</code> in <code>##AccountHolders</code>; conditional logic applied.           </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Address Country</strong>            </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Country Code]</code>                       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Country Code</code> in <code>##AccountHolders</code>.                                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Address Free</strong>               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Free Format]</code>                        </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Free Format</code> in <code>##AccountHolders</code>; conditionally updated.                </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Street</strong>               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Street]</code>                              </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Street</code> in <code>##AccountHolders</code>.                                          </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Building Identifier</strong>   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Building Number]</code>                     </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Building Number</code> in <code>##AccountHolders</code>.                                 </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Suite Identifier</strong>      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field; requires data source if applicable.                                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Floor Identifier</strong>      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field; requires data source if applicable.                                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed District Name</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>.                                        </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Post Office Box</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res PostCode]</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res PostCode</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Postal Code</strong>           </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res PostCode]</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res PostCode</code> in <code>##AccountHolders</code>.                                        </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed City</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res City]</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res City</code> in <code>##AccountHolders</code>.                                            </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Subentity</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>.                                        </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Birth Date</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Date Of Birth]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Date Of Birth</code> in <code>##AccountHolders</code>; conditionally updated.                 </p></td></tr><tr><td class="confluenceTd"><p><strong>Nationality</strong>                               </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Exclude</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Non-CRS element; exclude unless required by jurisdiction mandates.                          </p></td></tr><tr><td class="confluenceTd"><p><strong>Country of Birth</strong>                         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[CountryofBirthIdName]</code>                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>CountryofBirthIdName</code> in <code>##AccountHolders</code>.                               </p></td></tr><tr><td class="confluenceTd"><p><strong>POB City</strong>                                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res City]</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res City</code> in <code>##AccountHolders</code>; may require specific mapping.               </p></td></tr><tr><td class="confluenceTd"><p><strong>POB CitySubentity</strong>                        </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>; may require specific mapping.           </p></td></tr><tr><td class="confluenceTd"><p><strong>POB FormerCountryName</strong>                    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Country Code]</code>                        </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Country Code</code> in <code>##AccountHolders</code>; conditionally updated.              </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Type</strong>                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[CRS Type]</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Essential for reportable accounts; populated from <code>CRS Type</code> in <code>##AccountHolders</code>.           </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code</strong>      </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry1]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry1</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 2</strong>    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry2]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry2</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 3</strong>    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry3]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry3</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 4</strong>    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry4]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry4</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 5</strong>    </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry5]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry5</code> in <code>##AccountHolders</code>; conditionally updated.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN</strong>                   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN]</code>                                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN</code> in <code>##crsfinalselect</code>.                      </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 2</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN2]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN2</code> in <code>##crsfinalselect</code>.                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 3</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN3]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN3</code> in <code>##crsfinalselect</code>.                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 4</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN4]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN4</code> in <code>##crsfinalselect</code>.                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 5</strong>                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN5]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN5</code> in <code>##crsfinalselect</code>.                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry1]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry1</code>; conditional updates applied post-initial insert.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 2</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry2]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry2</code>; conditional updates applied post-initial insert.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 3</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry3]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry3</code>; conditional updates applied post-initial insert.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 4</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry4]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry4</code>; conditional updates applied post-initial insert.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 5</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry5]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry5</code>; conditional updates applied post-initial insert.                  </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Name Type</strong>             </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Requires manual population based on reporting requirements.                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Preceding Title</strong>       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Title</strong>                 </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person First Name</strong>            </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.FirstName</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>FirstName</code> in <code>##crsfinalselect</code>.                                            </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person First Name Type</strong>       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Middle Name</strong>           </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.MiddleName</code>                               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>MiddleName</code> in <code>##crsfinalselect</code>.                                           </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Middle Name Type</strong>      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Name Prefix</strong>           </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Name Prefix Type</strong>      </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Last Name</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.LastName</code>                                  </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>LastName</code> in <code>##crsfinalselect</code>.                                             </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Last Name Type</strong>        </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Generation Identifier</strong> </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Suffix</strong>                </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person General Suffix</strong>        </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional field based on data availability.                                                   </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Balance</strong>                           </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>balance</code>, <code>dividend</code>, <code>interest</code>            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>balance + dividend + interest</code>                                                              </p></td><td class="confluenceTd"><p>Required for all account types; populated based on financial metrics.                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Currency</strong>                          </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ad.currency</code>                                  </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Required for all account types; ensure correct ISO currency codes.                            </p></td></tr><tr><td class="confluenceTd"><p><strong>Interest</strong>                                  </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>i.interest</code>                                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>ISNULL(i.interest, 0)</code>                                                                      </p></td><td class="confluenceTd"><p>Conditional; populate only if interest data is available.                                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Interest Currency Code</strong>                   </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Conditional Assignment based on <code>Interest</code>                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN Interest &gt; 0 THEN ad.currency ELSE NULL END</code>                                      </p></td><td class="confluenceTd"><p>Required if <code>Interest</code> is populated; ensure correct ISO currency codes.                        </p></td></tr><tr><td class="confluenceTd"><p><strong>Dividends</strong>                                 </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>i.dividend</code>                                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>ISNULL(i.dividend, 0)</code>                                                                      </p></td><td class="confluenceTd"><p>Conditional; populate only if dividend data is available.                                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Dividends Currency Code</strong>                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Conditional Assignment based on <code>Dividends</code>               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN Dividends &gt; 0 THEN ad.currency ELSE NULL END</code>                                     </p></td><td class="confluenceTd"><p>Required if <code>Dividends</code> is populated; ensure correct ISO currency codes.                       </p></td></tr><tr><td class="confluenceTd"><p><strong>Gross Proceeds_Redemptions</strong>               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>ad.grossprocredem</code>                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>ad.grossprocredem</code>                                                                            </p></td><td class="confluenceTd"><p>Conditional; populate only if gross proceeds/redemptions data is available.                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Gross Proceeds_Redemptions Currency Code</strong>  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Conditional Assignment based on <code>Gross Proceeds_Redemptions</code> </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN Gross Proceeds_Redemptions &gt; 0 THEN ad.currency ELSE NULL END</code>                     </p></td><td class="confluenceTd"><p>Required if <code>Gross Proceeds_Redemptions</code> is populated; ensure correct ISO currency codes.       </p></td></tr><tr><td class="confluenceTd"><p><strong>Other</strong>                                     </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Exclude</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional and not currently used; recommended for removal.                                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Other Currency Code</strong>                       </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Conditional Assignment based on <code>Other</code>                   </p></td><td class="confluenceTd"><p><strong>Exclude</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Excluded as <code>Other</code> is excluded; remove to optimize data structure.                            </p></td></tr><tr><td class="confluenceTd"><p><strong>Line of Business</strong>                          </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; requires manual population based on business structure.              </p></td></tr><tr><td class="confluenceTd"><p><strong>Level 1</strong>                                   </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal segmentation; requires manual population.                                </p></td></tr><tr><td class="confluenceTd"><p><strong>Level 2</strong>                                   </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal segmentation; requires manual population.                                </p></td></tr><tr><td class="confluenceTd"><p><strong>Business Unit</strong>                             </p></td><td class="confluenceTd"><p>Step 5 / Manual Creation       </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>) or Mapped from source       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CONVERT(VARCHAR(50), '')</code> or <code>source.BusinessUnit</code>                                           </p></td><td class="confluenceTd"><p>New addition per CRS v3.19; requires data source or manual population.                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Business Sub Unit</strong>                         </p></td><td class="confluenceTd"><p>Step 5 / Manual Creation       </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>) or Mapped from source       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CONVERT(VARCHAR(50), '')</code> or <code>source.BusinessSubUnit</code>                                        </p></td><td class="confluenceTd"><p>New addition per CRS v3.19; requires data source or manual population.                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Business Sub Unit 2</strong>                       </p></td><td class="confluenceTd"><p>Step 5 / Manual Creation       </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>) or Mapped from source       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CONVERT(VARCHAR(50), '')</code> or <code>source.BusinessSubUnit2</code>                                      </p></td><td class="confluenceTd"><p>New addition per CRS v3.19; requires data source or manual population.                         </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 1</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 2</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 3</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 4</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 5</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 6</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 7</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 8</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 9</strong>                                  </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 10</strong>                                 </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 11</strong>                                 </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 12</strong>                                 </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Custom 13</strong>                                 </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p>Initially set to blank (<code>''</code>)                            </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Optional for internal use; initially blank.                                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Non Reportable</strong>                            </p></td><td class="confluenceTd"><p>Manual Creation                </p></td><td class="confluenceTd"><p><code>CASE</code> Statement based on <code>balance</code>, <code>dividend</code>, <code>interest</code> </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN balance + dividend + interest &lt;&gt; 0 THEN 0 ELSE 1 END</code>                              </p></td><td class="confluenceTd"><p>Flags accounts as non-reportable if financial metrics are zero.                                </p></td></tr><tr><td class="confluenceTd"><p><strong>Closure Date</strong>                              </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.ClosureDate</code>                               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN cr.ClosureDate IS NOT NULL AND cr.PortfolioServiceStatus NOT IN('Open', 'Pending closure') THEN cr.ClosureDate ELSE NULL END</code> </p></td><td class="confluenceTd"><p>Conditionally populated based on <code>ClosureDate</code> and <code>PortfolioServiceStatus</code>.                    </p></td></tr><tr><td class="confluenceTd"><p><strong>InceptionDate</strong>                             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[dsl_inceptiondate]</code>                       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Directly mapped from <code>dsl_inceptiondate</code> in <code>##crmdatafatcacrs</code>.                               </p></td></tr><tr><td class="confluenceTd"><p><strong>CRSCert</strong>                                   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[CRSCert]</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Directly mapped from <code>CRSCert</code> in <code>##crmdatafatcacrs</code>.                                        </p></td></tr><tr><td class="confluenceTd"><p><strong>AccountHolder</strong>                             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[AccountType]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>AccountType</code> in <code>##crmdatafatcacrs</code>.                                          </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_balance</strong>                               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(balance)</code>                                                                               </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total balance per <code>PortfolioNo</code>.                              </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_interest</strong>                              </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(interest)</code>                                                                              </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total interest per <code>PortfolioNo</code>.                             </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_dividends</strong>                             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(dividend)</code>                                                                               </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total dividends per <code>PortfolioNo</code>.                            </p></td></tr></tbody></table></div><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-3.SummaryofExclusionsandRetentions"><strong>3. Summary of Exclusions and Retentions</strong></h3><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-ExcludedColumns(MeanttobeBlank):"><strong>Excluded Columns (Meant to be Blank):</strong></h4><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="a26d2442-60fd-4e19-b988-8e936062ef6f" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p><strong>Column Name</strong></p></th><th class="confluenceTh"><p><strong>Reason for Exclusion</strong></p></th></tr><tr><td class="confluenceTd"><p><strong>Nationality</strong>                     </p></td><td class="confluenceTd"><p>Non-CRS element; exclude unless required by jurisdiction mandates.            </p></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Nationality</strong>  </p></td><td class="confluenceTd"><p>Non-CRS element; exclude unless required by jurisdiction mandates.            </p></td></tr><tr><td class="confluenceTd"><p><strong>Other</strong>                           </p></td><td class="confluenceTd"><p>Optional and not currently used; recommended for removal.                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Other Currency Code</strong>             </p></td><td class="confluenceTd"><p>Excluded as <code>Other</code> is excluded; remove to optimize data structure.            </p></td></tr></tbody></table></div><p><strong>Total Excluded Columns:</strong> <strong>4</strong></p><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-4.DetailedColumnSourcesandCreationMethodswithLogicCapture"><strong>4. Detailed Column Sources and Creation Methods with Logic Capture</strong></h3><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-a.ColumnsSourcedfromStep5(DataExtractionandTransformation):"><strong>a. Columns Sourced from Step 5 (Data Extraction and Transformation):</strong></h4><p>These columns are directly mapped from data extraction steps, primarily from temporary tables like <code>##AccountHolders</code> and <code>##crsfinalselect</code>. They do not involve complex logic beyond simple mappings.</p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="eaf9ab65-d4bc-4a1a-916a-3fb8148aea42" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p><strong>Column Name</strong></p></th><th class="confluenceTh"><p><strong>Source Detail</strong></p></th><th class="confluenceTh"><p><strong>Notes</strong></p></th><th class="confluenceTh"><p /></th><th class="confluenceTh"><p /></th><th class="confluenceTh"><p /></th></tr><tr><td class="confluenceTd"><p><strong>Operation Type</strong>                      </p></td><td class="confluenceTd"><p>Mapped from <code>@OperationType</code>                              </p></td><td class="confluenceTd"><p>Indicates the operation type (e.g., New, Modify).        </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Reporting Jurisdiction</strong>              </p></td><td class="confluenceTd"><p>Static Value <code>'NZ'</code>                                       </p></td><td class="confluenceTd"><p>Modify as per jurisdiction.                             </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Recipient ID</strong>                        </p></td><td class="confluenceTd"><p>Concatenation of <code>Account ID</code> + <code>PortfolioNo</code>             </p></td><td class="confluenceTd"><p>Ensures unique identification.                          </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Reportable Account Type</strong>             </p></td><td class="confluenceTd"><p>Mapped from <code>dsl_PortfolioServiceLevelName</code>               </p></td><td class="confluenceTd"><p>Determines account type based on service level.          </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Number</strong>                      </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[PortfolioNo]</code>                            </p></td><td class="confluenceTd"><p>Direct mapping from CRM data.                            </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>PortfolioServiceLevelName</strong>           </p></td><td class="confluenceTd"><p>Mapped from <code>cr.dsl_PortfolioServiceLevelName</code>            </p></td><td class="confluenceTd"><p>Direct mapping from CRM data.                            </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Tax Jurisdiction</strong>     </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry1</code> to <code>ah.taxcountry5</code>          </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN</strong>                   </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN1</code> to <code>ah.TIN5</code>                        </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Type</strong>              </p></td><td class="confluenceTd"><p>Mapped from <code>ah.TIN1_type</code> to <code>ah.TIN5_type</code>              </p></td><td class="confluenceTd"><p>Populated from <code>##AccountHolders</code> table.                </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder IN Issued By Country Code 1-5</strong> </p></td><td class="confluenceTd"><p>Mapped from <code>ah.taxcountry1</code> to <code>ah.taxcountry5</code>          </p></td><td class="confluenceTd"><p>Derived from <code>taxcountry1</code> to <code>taxcountry5</code>.            </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Organization Name</strong>    </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Business Name]</code>                           </p></td><td class="confluenceTd"><p>Populated from <code>Business Name</code> in <code>##AccountHolders</code>.    </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Address Country</strong>      </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Country Code]</code>                        </p></td><td class="confluenceTd"><p>Populated from <code>Res Country Code</code> in <code>##AccountHolders</code>. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Address Free</strong>         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Free Format]</code>                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Free Format</code> in <code>##AccountHolders</code>.  </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Street</strong>         </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Street]</code>                               </p></td><td class="confluenceTd"><p>Populated from <code>Res Street</code> in <code>##AccountHolders</code>.       </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Building Identifier</strong> </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Building Number]</code>                     </p></td><td class="confluenceTd"><p>Populated from <code>Res Building Number</code> in <code>##AccountHolders</code>. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed District Name</strong>   </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>.     </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Post Office Box</strong> </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res PostCode]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>Res PostCode</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Postal Code</strong>     </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res PostCode]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>Res PostCode</code> in <code>##AccountHolders</code>.     </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed City</strong>            </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res City]</code>                                 </p></td><td class="confluenceTd"><p>Populated from <code>Res City</code> in <code>##AccountHolders</code>.         </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Fixed Subentity</strong>       </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>.     </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Account Holder Birth Date</strong>            </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Date Of Birth]</code>                            </p></td><td class="confluenceTd"><p>Populated from <code>Date Of Birth</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Country of Birth</strong>                     </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[CountryofBirthIdName]</code>                     </p></td><td class="confluenceTd"><p>Populated from <code>CountryofBirthIdName</code> in <code>##AccountHolders</code>. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>POB City</strong>                             </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res City]</code>                                 </p></td><td class="confluenceTd"><p>Populated from <code>Res City</code> in <code>##AccountHolders</code>; may require specific mapping. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>POB CitySubentity</strong>                    </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res District]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>Res District</code> in <code>##AccountHolders</code>; may require specific mapping. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>POB FormerCountryName</strong>                </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[Res Country Code]</code>                         </p></td><td class="confluenceTd"><p>Populated from <code>Res Country Code</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Type</strong>              </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[CRS Type]</code>                                 </p></td><td class="confluenceTd"><p>Essential for reportable accounts; populated from <code>CRS Type</code> in <code>##AccountHolders</code>. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code</strong>  </p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry1]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry1</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 2</strong></p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry2]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry2</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 3</strong></p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry3]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry3</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 4</strong></p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry4]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry4</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Tax Country Code 5</strong></p></td><td class="confluenceTd"><p>Mapped from <code>ah.[TaxCountry5]</code>                             </p></td><td class="confluenceTd"><p>Populated from <code>TaxCountry5</code> in <code>##AccountHolders</code>; conditionally updated. </p></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN</strong>               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN]</code>                                    </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN</code> in <code>##crsfinalselect</code>.                      </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 2</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN2]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN2</code> in <code>##crsfinalselect</code>.                     </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 3</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN3]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN3</code> in <code>##crsfinalselect</code>.                     </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 4</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN4]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN4</code> in <code>##crsfinalselect</code>.                     </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person TIN 5</strong>             </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TIN5]</code>                                   </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Critical for CRS compliance; populated from <code>TIN5</code> in <code>##crsfinalselect</code>.                     </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By</strong>     </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry1]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry1</code>; conditional updates applied post-initial insert.                  </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 2</strong>   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry2]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry2</code>; conditional updates applied post-initial insert.                  </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 3</strong>   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry3]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry3</code>; conditional updates applied post-initial insert.                  </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 4</strong>   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry4]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry4</code>; conditional updates applied post-initial insert.                  </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person TIN Issued By 5</strong>   </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.[TaxCountry5]</code>                           </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Derived from <code>TaxCountry5</code>; conditional updates applied post-initial insert.                  </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person First Name</strong>        </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.FirstName</code>                                </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Populated from <code>FirstName</code> in <code>##crsfinalselect</code>.                                            </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling Person Middle Name</strong>       </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.MiddleName</code>                               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Populated from <code>MiddleName</code> in <code>##crsfinalselect</code>.                                           </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Controlling person Last Name</strong>         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>sah.LastName</code>                                  </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>Populated from <code>LastName</code> in <code>##crsfinalselect</code>.                                             </p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p><strong>Closure Date</strong>                          </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.ClosureDate</code>                               </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN cr.ClosureDate IS NOT NULL AND cr.PortfolioServiceStatus NOT IN('Open', 'Pending closure') THEN cr.ClosureDate ELSE NULL END</code> </p></td><td class="confluenceTd"><p>Conditionally populated based on <code>ClosureDate</code> and <code>PortfolioServiceStatus</code>.                    </p></td></tr><tr><td class="confluenceTd"><p><strong>InceptionDate</strong>                         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[dsl_inceptiondate]</code>                       </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Directly mapped from <code>dsl_inceptiondate</code> in <code>##crmdatafatcacrs</code>.                               </p></td></tr><tr><td class="confluenceTd"><p><strong>CRSCert</strong>                               </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[CRSCert]</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Directly mapped from <code>CRSCert</code> in <code>##crmdatafatcacrs</code>.                                        </p></td></tr><tr><td class="confluenceTd"><p><strong>AccountHolder</strong>                         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Mapped from <code>cr.[AccountType]</code>                             </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p>N/A                                                                                         </p></td><td class="confluenceTd"><p>Populated from <code>AccountType</code> in <code>##crmdatafatcacrs</code>.                                          </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_balance</strong>                           </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(balance)</code>                                                                               </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total balance per <code>PortfolioNo</code>.                              </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_interest</strong>                          </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(interest)</code>                                                                              </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total interest per <code>PortfolioNo</code>.                             </p></td></tr><tr><td class="confluenceTd"><p><strong>agg_dividends</strong>                         </p></td><td class="confluenceTd"><p>Step 5                         </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code>                                 </p></td><td class="confluenceTd"><p><strong>Retain</strong> </p></td><td class="confluenceTd"><p><code>SUM(dividend)</code>                                                                               </p></td><td class="confluenceTd"><p>Aggregated from <code>cte_income</code> for total dividends per <code>PortfolioNo</code>.                            </p></td></tr></tbody></table></div><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-5.ImplementationRecommendations"><strong>5. Implementation Recommendations</strong></h3><p>To align your SQL code with CRS v3.19 requirements and optimize data structures, follow these recommendations:</p><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-a.ExcludeIdentifiedBlankColumns"><strong>a. Exclude Identified Blank Columns</strong></h4><p>Remove the following <strong>4 columns</strong> from both the <code>##crsfinalselect</code> temporary table and the final <code>INSERT</code> statement to streamline data processing:</p><ol start="1"><li><p><strong>Nationality</strong></p></li><li><p><strong>Controlling Person Nationality</strong></p></li><li><p><strong>Other</strong></p></li><li><p><strong>Other Currency Code</strong></p></li></ol><p><strong>Example Adjustment:</strong></p><p><strong>Before Exclusion:</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">SELECT 
    -- Existing columns
    ...
    &#39;&#39; AS &#39;Nationality&#39;,
    &#39;&#39; AS &#39;Controlling Person Nationality&#39;,
    &#39;&#39; AS &#39;Other&#39;,
    &#39;&#39; AS &#39;Other Currency Code&#39;,
    -- ... other columns ...</pre>
</div></div><p><strong>After Exclusion:</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">SELECT 
    -- Existing columns
    ...
    -- Removed columns meant to be blank
    -- &#39;Nationality&#39;, &#39;Controlling Person Nationality&#39;, &#39;Other&#39;, &#39;Other Currency Code&#39;
    -- ... other columns ...</pre>
</div></div><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-b.IntegrateNewCRSv3.19Columns"><strong>b. Integrate New CRS v3.19 Columns</strong></h4><p>Incorporate the <strong>three new columns</strong> introduced in CRS v3.19:</p><ol start="1"><li><p><strong>Business Unit</strong></p></li><li><p><strong>Business Sub Unit</strong></p></li><li><p><strong>Business Sub Unit 2</strong></p></li></ol><p><strong>Steps to Integrate:</strong></p><ol start="1"><li><p><strong>Modify </strong><code>##crsfinalselect</code>:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">SELECT 
    @OperationType AS &#39;Operation Type&#39;,
    &#39;NZ&#39; AS &#39;Reporting Jurisdiction&#39;,
    -- ... existing columns ...
    CONVERT(VARCHAR(50), &#39;&#39;) AS &#39;Business Unit&#39;,         -- New Column
    CONVERT(VARCHAR(50), &#39;&#39;) AS &#39;Business Sub Unit&#39;,     -- New Column
    CONVERT(VARCHAR(50), &#39;&#39;) AS &#39;Business Sub Unit 2&#39;,   -- New Column
    -- ... remaining columns ...
INTO ##crsfinalselect
FROM ##AccountDetails ad
    -- ... existing joins ...</pre>
</div></div></li><li><p><strong>Populate New Columns:</strong></p><ul><li><p><strong>Option 1:</strong> If business unit information exists in your source tables, join and map them accordingly.</p></li><li><p><strong>Option 2:</strong> If not, consider manual population or setting default values based on business logic.</p></li></ul><p><strong>Example:</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">SELECT 
    -- Existing columns
    ...
    bu.BusinessUnitName AS &#39;Business Unit&#39;,
    bs.BusinessSubUnitName AS &#39;Business Sub Unit&#39;,
    bsu2.BusinessSubUnit2Name AS &#39;Business Sub Unit 2&#39;,
    -- ... remaining columns ...
INTO ##crsfinalselect
FROM ##AccountDetails ad
    LEFT JOIN BusinessUnits bu ON ad.BusinessUnitID = bu.ID
    LEFT JOIN BusinessSubUnits bs ON ad.BusinessSubUnitID = bs.ID
    LEFT JOIN BusinessSubUnits2 bsu2 ON ad.BusinessSubUnit2ID = bsu2.ID
    -- ... existing joins ...</pre>
</div></div></li><li><p><strong>Update Final </strong><code>INSERT</code> Statement:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">INSERT INTO [FATCA].[CRS_AccountDetail_Holders_Owners] (
    ReportingYear,
    LastUpdated,
    ReportingEntityType,
    [Operation Type],
    [Reporting Jurisdiction],
    [Recipient ID],
    [Reportable Account Type],
    [Filer / Sponsored Entity Short Name],
    [Account Number],
    [Account Number Type],
    [Line of Business],
    [Level 1],
    [Level 2],
    [Business Unit],             -- New Column
    [Business Sub Unit],         -- New Column
    [Business Sub Unit 2],       -- New Column
    -- ... other columns ...
)
SELECT 
    @rptYear AS ReportingYear,
    GetDate() AS LastUpdated,
    ReportingEntityType,
    [Operation Type],
    [Reporting Jurisdiction],
    [Recipient ID],
    [Reportable Account Type],
    [Filer / Sponsored Entity Short Name],
    [Account Number],
    [Account Number Type],
    [Line of Business],
    [Level 1],
    [Level 2],
    [Business Unit],             -- New Column
    [Business Sub Unit],         -- New Column
    [Business Sub Unit 2],       -- New Column
    -- ... other columns ...
FROM ##crsfinalselect</pre>
</div></div></li></ol><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-c.CaptureandRecreateSpecialLogic"><strong>c. Capture and Recreate Special Logic</strong></h4><p>For columns that involve special logic (e.g., <code>CASE WHEN</code>, arithmetic operations, <code>IS NULL</code>), ensure that the logic is well-documented and can be recreated or maintained easily.</p><p><strong>Example:</strong></p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="1f0deff7-99fb-4964-bc32-5b9ceeb81c90" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p><strong>Column Name</strong></p></th><th class="confluenceTh"><p><strong>Logic</strong></p></th></tr><tr><td class="confluenceTd"><p><strong>ReportingEntityType</strong>                  </p></td><td class="confluenceTd"><p><code>CASE WHEN dsl_PortfolioServiceLevelName = 'Level1' THEN 'TypeA' ELSE 'TypeB' END</code>          </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Undocumented</strong>     </p></td><td class="confluenceTd"><p><code>CASE WHEN TaxRegime = 'X' AND CRSCert IS NULL THEN 'Undocumented' ELSE '' END</code>             </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Closed</strong>           </p></td><td class="confluenceTd"><p><code>CASE WHEN ClosureDate IS NOT NULL AND PortfolioServiceStatus NOT IN('Open', 'Pending closure') THEN 'Closed' ELSE '' END</code> </p></td></tr><tr><td class="confluenceTd"><p><strong>Account Description-Dormant</strong>          </p></td><td class="confluenceTd"><p><code>CASE WHEN RAT = 1 THEN 'Dormant' ELSE '' END</code>                                              </p></td></tr><tr><td class="confluenceTd"><p><strong>Non Reportable</strong>                       </p></td><td class="confluenceTd"><p><code>CASE WHEN balance + dividend + interest &lt;&gt; 0 THEN 0 ELSE 1 END</code>                              </p></td></tr><tr><td class="confluenceTd"><p><strong>Closure Date</strong>                         </p></td><td class="confluenceTd"><p><code>CASE WHEN cr.ClosureDate IS NOT NULL AND cr.PortfolioServiceStatus NOT IN('Open', 'Pending closure') THEN cr.ClosureDate ELSE NULL END</code> </p></td></tr><tr><td class="confluenceTd"><p><strong>Interest Currency Code</strong>               </p></td><td class="confluenceTd"><p><code>CASE WHEN Interest &gt; 0 THEN ad.currency ELSE NULL END</code>                                     </p></td></tr><tr><td class="confluenceTd"><p><strong>Dividends Currency Code</strong>              </p></td><td class="confluenceTd"><p><code>CASE WHEN Dividends &gt; 0 THEN ad.currency ELSE NULL END</code>                                    </p></td></tr><tr><td class="confluenceTd"><p><strong>Gross Proceeds_Redemptions Currency Code</strong> </p></td><td class="confluenceTd"><p><code>CASE WHEN Gross Proceeds_Redemptions &gt; 0 THEN ad.currency ELSE NULL END</code>                     </p></td></tr></tbody></table></div><p><strong>Recommendation:</strong> Maintain a separate documentation file or a dedicated section within your SQL script that details the logic for these columns. This practice facilitates easier maintenance and ensures that the logic can be accurately recreated or modified as CRS requirements evolve.</p><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-6.EnhancedImplementationSteps"><strong>6. Enhanced Implementation Steps</strong></h3><p>To further optimize your SQL script and ensure compliance with CRS v3.19, follow these enhanced implementation steps:</p><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-a.ExcludeIdentifiedBlankColumns.1"><strong>a. Exclude Identified Blank Columns</strong></h4><p>As detailed above, remove the <strong>4 excluded columns</strong> to streamline data processing.</p><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-b.IntegrateNewCRSv3.19Columns.1"><strong>b. Integrate New CRS v3.19 Columns</strong></h4><p>Ensure the three new columns (<strong>Business Unit</strong>, <strong>Business Sub Unit</strong>, <strong>Business Sub Unit 2</strong>) are accurately integrated and populated based on your data sources or business logic.</p><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-c.CaptureandDocumentSpecialLogic"><strong>c. Capture and Document Special Logic</strong></h4><p>For columns involving special logic:</p><ol start="1"><li><p><strong>Document the Logic:</strong></p><ul><li><p>Create a detailed documentation section that captures the exact <code>CASE</code> statements, arithmetic operations, and functions used.</p></li><li><p>Example:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">-- ReportingEntityType Logic
CASE 
    WHEN dsl_PortfolioServiceLevelName = &#39;Level1&#39; THEN &#39;TypeA&#39;
    ELSE &#39;TypeB&#39;
END AS &#39;ReportingEntityType&#39;

-- Account Description-Undocumented Logic
CASE 
    WHEN TaxRegime = &#39;X&#39; AND CRSCert IS NULL THEN &#39;Undocumented&#39;
    ELSE &#39;&#39;
END AS &#39;Account Description-Undocumented&#39;</pre>
</div></div></li></ul></li><li><p><strong>Implement as SQL Comments:</strong></p><ul><li><p>Embed comments within your SQL script to describe the logic applied to each column.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">-- ReportingEntityType Logic
CASE 
    WHEN dsl_PortfolioServiceLevelName = &#39;Level1&#39; THEN &#39;TypeA&#39;
    ELSE &#39;TypeB&#39;
END AS &#39;ReportingEntityType&#39;,

-- Account Description-Undocumented Logic
CASE 
    WHEN TaxRegime = &#39;X&#39; AND CRSCert IS NULL THEN &#39;Undocumented&#39;
    ELSE &#39;&#39;
END AS &#39;Account Description-Undocumented&#39;,</pre>
</div></div></li></ul></li><li><p><strong>Maintain a Logic Mapping Document:</strong></p><ul><li><p>Create a separate document that maps each column to its logic. This practice aids in future audits and troubleshooting.</p></li></ul></li></ol><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-d.ValidateConditionalFieldsandLogic"><strong>d. Validate Conditional Fields and Logic</strong></h4><p>Ensure that all conditional fields are accurately populated based on CRS v3.19 requirements:</p><ul><li><p><strong>Date Fields:</strong> Verify proper date formats and validations.</p></li><li><p><strong>Country Codes:</strong> Confirm all ISO country codes are correct and applicable.</p></li><li><p><strong>TIN Fields:</strong> Ensure TINs are populated as required, with appropriate placeholders where necessary.</p></li><li><p><strong>Reportable Account Types:</strong> Confirm that account types are correctly classified per CRS v3.19 definitions.</p></li></ul><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-e.RemoveNon-CRSElements"><strong>e. Remove Non-CRS Elements</strong></h4><p>As previously outlined, exclude <strong>non-CRS elements</strong> like <strong>Nationality</strong> and <strong>Controlling Person Nationality</strong> unless specifically required by jurisdiction mandates.</p><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-f.EnhanceDataIntegrityandValidation"><strong>f. Enhance Data Integrity and Validation</strong></h4><p>Implement additional validation checks to ensure data accuracy:</p><ul><li><p><strong>Unique Constraints:</strong> Ensure <code>Recipient ID</code> is unique per jurisdiction.</p></li><li><p><strong>Data Type Enforcement:</strong> Confirm that numeric fields like <code>Account Balance</code>, <code>Interest</code>, etc., adhere to required formats and decimal places.</p></li><li><p><strong>Referential Integrity:</strong> Ensure that all foreign keys and references are correctly maintained.</p></li></ul><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-g.MaintainComprehensiveDocumentation"><strong>g. Maintain Comprehensive Documentation</strong></h4><p>Keep thorough documentation of all changes made to the SQL script, including:</p><ul><li><p><strong>Column Additions/Exclusions:</strong> Clearly note which columns were added or removed.</p></li><li><p><strong>Logic Modifications:</strong> Document any changes to <code>CASE</code> statements or conditional logic.</p></li><li><p><strong>Compliance Checks:</strong> Record validations performed to ensure adherence to CRS v3.19.</p></li></ul><h4 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-h.ConductThoroughTesting"><strong>h. Conduct Thorough Testing</strong></h4><p>Before deploying the updated SQL script:</p><ol start="1"><li><p><strong>Unit Testing:</strong> Test individual components to ensure each part functions as expected.</p></li><li><p><strong>Integration Testing:</strong> Validate that the new columns integrate seamlessly with existing data flows.</p></li><li><p><strong>Compliance Testing:</strong> Cross-verify sample outputs against CRS v3.19 requirements to ensure full compliance.</p></li></ol><hr/><h3 id="id-18.6Step8tostep9-CRSv3.19SQLColumnsComprehensiveAuditandOptimization-7.FinalRecommendations"><strong>7. Final Recommendations</strong></h3><ol start="1"><li><p><strong>Streamline Columns:</strong> By excluding the 4 identified blank columns and integrating new CRS v3.19 columns, you enhance performance and maintain data clarity.</p></li><li><p><strong>Accurate Mapping:</strong> Verify that all columns sourced from Step 5 are correctly mapped and populated.</p></li><li><p><strong>Document Special Logic:</strong> Ensure that all special logic used in column creation is well-documented and easily accessible.</p></li><li><p><strong>Validate Conditional Logic:</strong> Regularly test the conditional mappings and <code>CASE</code> statements to ensure they function as intended.</p></li><li><p><strong>Maintain Compliance:</strong> Stay updated with any future CRS updates and adjust the SQL script accordingly.</p></li><li><p><strong>Stakeholder Communication:</strong> Inform relevant teams about the changes to ensure seamless integration and understanding across departments.</p></li></ol><p>By implementing these recommendations, your SQL code will be optimized for CRS v3.19 compliance, ensuring accurate and efficient tax reporting.</p><p /><p /><hr/><p><strong>Best Approach to Joining Data for CRS Reporting</strong></p><p>Based on the scenario you've described, the best approach is indeed to join the same table twiceâ€”once for Account Holder details and once for Controlling Person details. Here's why and how you should proceed:</p><ol start="1"><li><p><strong>Understanding the Data Structure:</strong></p><ul><li><p><strong>Account Holders</strong> can be either <strong>Individuals</strong> or <strong>Entities</strong>.</p></li><li><p><strong>Controlling Persons</strong> are associated with <strong>Entity Account Holders</strong>.</p></li><li><p>Both Account Holder and Controlling Person data are stored in the same table (<code>FATCA.Stage_CRSPivotedData_jf</code>), but they represent different roles and have different applicable fields.</p></li></ul></li><li><p><strong>Justifying the Double Join:</strong></p><ul><li><p><strong>Joining the same table twice</strong> allows you to <strong>separately retrieve</strong> data for Account Holders and Controlling Persons.</p></li><li><p>This approach ensures that you can <strong>populate the correct sections</strong> in your final CRS output based on the type of Account Holder.</p></li></ul></li><li><p><strong>Implementing the Joins:</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">-- Account Holder Join (Individuals and Entities)
LEFT JOIN FATCA.Stage_CRSPivotedData_jf ah 
    ON ad.[ee_uniqueID] = ah.[AccountID]
    AND ad.[Account Number] = ah.[PortfolioNo]
    AND ad.PortfolioServiceLevelName = ah.PortfolioServiceLevelName
    -- This join fetches Account Holder details.

-- Controlling Person Join (Entities Only)
LEFT JOIN FATCA.Stage_CRSPivotedData_jf cp 
    ON ad.[ee_uniqueID] = cp.[AccountID]
    AND ad.[Account Number] = cp.[PortfolioNo]
    AND ad.PortfolioServiceLevelName = cp.PortfolioServiceLevelName
    AND cp.AccountType IN (&#39;Layered Entity&#39;, &#39;Normal Entity&#39;)
    -- This join fetches Controlling Person details for Entity Account Holders.</pre>
</div></div></li><li><p><strong>Handling Field Selection in the SELECT Clause:</strong></p><ul><li><p>Use <strong>CASE statements</strong> or <strong>conditional logic</strong> to select the appropriate fields based on the <code>AccountType</code>.</p></li><li><p>For <strong>Individual Account Holders</strong>:</p><ul><li><p>Populate the Account Holder section with personal details.</p></li><li><p>Leave the Controlling Person section blank.</p></li></ul></li><li><p>For <strong>Entity Account Holders</strong>:</p><ul><li><p>Populate the Account Holder section with entity details.</p></li><li><p>Populate the Controlling Person section with controlling person details.</p></li></ul></li></ul><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: false; theme: Confluence" data-theme="Confluence">SELECT
    -- Account Holder Tax Jurisdiction
    CASE
        WHEN ah.AccountType IN (&#39;Multiple TINs Individual&#39;, &#39;Single TIN Individual&#39;) THEN ah.TaxCountry1
        WHEN ah.AccountType IN (&#39;Layered Entity&#39;, &#39;Normal Entity&#39;) THEN ah.EntityTaxCodeCountryISOShort
        ELSE NULL
    END AS &#39;Account Holder Tax Jurisdiction&#39;,

    -- Account Holder TIN
    CASE
        WHEN ah.AccountType IN (&#39;Multiple TINs Individual&#39;, &#39;Single TIN Individual&#39;) THEN ah.TIN1
        WHEN ah.AccountType IN (&#39;Layered Entity&#39;, &#39;Normal Entity&#39;) THEN ah.EntityTIN
        ELSE NULL
    END AS &#39;Account Holder TIN&#39;,

    -- Controlling Person Details (only for Entity Account Holders)
    cp.ControllingPersonName AS &#39;Controlling Person Name&#39;,
    cp.ControllingPersonTIN AS &#39;Controlling Person TIN&#39;,
    -- Include other Controlling Person fields as necessary.</pre>
</div></div></li><li><p><strong>Ensuring Data Integrity:</strong></p><ul><li><p><strong>Validate your data</strong> to ensure that Individual Account Holders do not have Controlling Person data.</p></li><li><p><strong>Check for any anomalies</strong> where Entity Account Holders might be missing Controlling Person data when they shouldn't.</p></li></ul></li><li><p><strong>Best Practices:</strong></p><ul><li><p><strong>Clear Separation of Roles:</strong> Even though the data comes from the same table, treating Account Holders and Controlling Persons as distinct entities in your query helps maintain clarity.</p></li><li><p><strong>Documentation:</strong> Comment your SQL code to explain the logic, making it easier for others (or yourself in the future) to understand the joins and field selections.</p></li><li><p><strong>Modularity:</strong> If possible, create views or CTEs (Common Table Expressions) to handle complex logic, which can make your main query cleaner.</p></li></ul></li><li><p><strong>Alternative Approach (If Feasible):</strong></p><ul><li><p><strong>Data Preprocessing:</strong> Consider creating separate views or staging tables for Account Holders and Controlling Persons. This can simplify your joins and make your SELECT clause cleaner.</p></li><li><p><strong>Restructuring Data Model:</strong> If you have control over the data source, splitting the roles into separate tables can improve clarity and maintainability.</p></li></ul></li></ol><p><strong>Conclusion:</strong></p><p>Joining the same table twice is appropriate in this context, as it allows you to differentiate between Account Holder and Controlling Person data effectively. By using conditional logic in your SELECT clause, you can ensure that the correct fields are populated based on the AccountType, resulting in accurate and compliant CRS reporting.</p><p><strong>Remember:</strong> Always test your query thoroughly to ensure that all scenarios are handled correctly and that the final output meets the reporting requirements.</p><hr/><p><strong>For Individuals:</strong></p><ul><li><p><strong>Use the Individual's TIN:</strong></p><ul><li><p>Report the Tax Identification Number (TIN) of the individual account holder as it appears in your records.</p></li><li><p>Ensure the TIN is correctly formatted according to the issuing country's standards.</p></li></ul></li></ul><p><strong>For Entities:</strong></p><ul><li><p><strong>Use the Entity's TIN:</strong></p><ul><li><p>Report the TIN or equivalent identification number of the entity account holder.</p></li><li><p>This could be a company registration number, GIIN, or other similar identifier used in the entity's country of tax residence.</p></li><li><p>Ensure the TIN is correctly formatted according to the issuing country's standards.</p></li></ul></li></ul><p><strong>If TIN Is Unavailable:</strong></p><ul><li><p><strong>Use &quot;No TIN Reason&quot; Codes:</strong></p><ul><li><p>If the TIN is not available after making reasonable efforts to obtain it, you may use the appropriate &quot;No TIN Reason&quot; code permitted by the reporting jurisdiction (e.g., &quot;Reason A,&quot; &quot;Reason B,&quot; or &quot;Reason C&quot;).</p></li><li><p><strong>Example Reasons:</strong></p><ul><li><p><strong>Reason A:</strong> The jurisdiction does not issue TINs.</p></li><li><p><strong>Reason B:</strong> The account holder is unable to obtain a TIN.</p></li><li><p><strong>Reason C:</strong> The jurisdiction does not require the TIN to be disclosed.</p></li></ul></li></ul></li><li><p><strong>Jurisdiction-Specific Requirements:</strong></p><ul><li><p>Some countries have specific codes or placeholders to use when TINs are unavailable (e.g., &quot;000000000,&quot; &quot;NOTIN,&quot; &quot;noTINavailable&quot;).</p></li><li><p>Always refer to the specific guidelines of the reporting jurisdiction.</p></li></ul></li></ul><p><strong>Summary:</strong></p><ul><li><p><strong>Individuals:</strong> Report the individual's TIN as per your records.</p></li><li><p><strong>Entities:</strong> Report the entity's TIN or equivalent identifier.</p></li><li><p><strong>Unavailable TINs:</strong> Use appropriate &quot;No TIN Reason&quot; codes or placeholders as allowed.</p></li><li><p><strong>Compliance:</strong> Ensure all TINs or codes meet the formatting and reporting requirements of each jurisdiction involved.</p></li></ul><p /><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="attachments/2773942273/2778104019.xlsx" data-nice-type="Microsoft Excel Spreadsheet" data-file-src="/wiki/download/attachments/2773942273/WorkSheet-CRS%20output%20mapping.xlsx?version=2&amp;modificationDate=1729195985583&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="2778104019" data-linked-resource-type="attachment" data-linked-resource-container-id="2773942273" data-linked-resource-default-alias="WorkSheet-CRS output mapping.xlsx" data-mime-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" data-has-thumbnail="true" data-linked-resource-version="2" data-media-id="bdf067f8-83e5-4c3c-a0b2-946e7c95f424" data-media-type="file"><img src="attachments/thumbnails/2773942273/2778104019" height="250"/></a></span> </p><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="attachments/2773942273/2778693876.sql" data-nice-type="Text File" data-file-src="/wiki/download/attachments/2773942273/Workscipt%20%235.8%20%20Updated%20script%20missing%20country%20code%20using%20reference%20table.sql?version=1&amp;modificationDate=1729196018920&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="2778693876" data-linked-resource-type="attachment" data-linked-resource-container-id="2773942273" data-linked-resource-default-alias="Workscipt #5.8  Updated script missing country code using reference table.sql" data-mime-type="text/plain" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="5a2ad9a4-9cb6-4b4c-ac07-813d2a2846f3" data-media-type="file"><img src="attachments/thumbnails/2773942273/2778693876" height="250"/></a></span> </p><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="attachments/2773942273/2778169571.xlsx" data-nice-type="Microsoft Excel Spreadsheet" data-file-src="/wiki/download/attachments/2773942273/Missing%20ISO%20Countries%20Code%20from%20Source%20Application%20JF%20summarised%2023.09.2024.xlsx?version=1&amp;modificationDate=1729195942179&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="2778169571" data-linked-resource-type="attachment" data-linked-resource-container-id="2773942273" data-linked-resource-default-alias="Missing ISO Countries Code from Source Application JF summarised 23.09.2024.xlsx" data-mime-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="9cf335b4-0534-4bba-9005-1c319cc2cd2e" data-media-type="file"><img src="attachments/thumbnails/2773942273/2778169571" height="250"/></a></span> </p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2778169547.sql">Workscipt #6  Try to bring in Accoundetails and build the final CRS output.sql</a> (binary/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2779709492.sql">Workscipt #6.4  Create Nams and Address Cleaning fucntion for XML.sql</a> (binary/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2778169571.xlsx">Missing ISO Countries Code from Source Application JF summarised 23.09.2024.xlsx</a> (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2779119867.xlsx">WorkSheet-CRS output mapping.xlsx</a> (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2778104019.xlsx">WorkSheet-CRS output mapping.xlsx</a> (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/2773942273/2778693876.sql">Workscipt #5.8  Updated script missing country code using reference table.sql</a> (text/plain)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on 18-08-25 20:53</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
